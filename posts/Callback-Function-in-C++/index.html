<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"> </script><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Designing Callbacks in C++" /><meta property="og:locale" content="en" /><meta name="description" content="In this article we will discuss what is a callback and what types of callbacks we can have in C++ and how to Design Callbacks it." /><meta property="og:description" content="In this article we will discuss what is a callback and what types of callbacks we can have in C++ and how to Design Callbacks it." /><link rel="canonical" href="https://lacie-life.github.io/posts/Callback-Function-in-C++/" /><meta property="og:url" content="https://lacie-life.github.io/posts/Callback-Function-in-C++/" /><meta property="og:site_name" content="Life Zero Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-03T11:11:14+07:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Designing Callbacks in C++" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-03T16:10:48+07:00","datePublished":"2023-01-03T11:11:14+07:00","description":"In this article we will discuss what is a callback and what types of callbacks we can have in C++ and how to Design Callbacks it.","headline":"Designing Callbacks in C++","mainEntityOfPage":{"@type":"WebPage","@id":"https://lacie-life.github.io/posts/Callback-Function-in-C++/"},"url":"https://lacie-life.github.io/posts/Callback-Function-in-C++/"}</script><title>Designing Callbacks in C++ | Life Zero Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Life Zero Blog"><meta name="application-name" content="Life Zero Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang=""><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://live.staticflickr.com/7347/14119381583_6087a61c73_c_d.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Life Zero Blog</a></div><div class="site-subtitle font-italic">Life is hard but it's fair</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/lacie-life" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['00sao00ios00','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Designing Callbacks in C++</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"> <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Designing Callbacks in C++</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Life Zero </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Jan 3, 2023, 11:11 AM +0700" >Jan 3<i class="unloaded">2023-01-03T11:11:14+07:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Jan 3, 2023, 4:10 PM +0700" >Jan 3<i class="unloaded">2023-01-03T16:10:48+07:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2233 words">12 min read</span></div></div><div class="post-content"><p>In this article we will discuss what is a callback and what types of callbacks we can have in C++ and how to Design Callbacks it.</p><h2 id="now-what-is-a-callback">Now what is a callback?</h2><p>Callback is a function that we pass to another APIs as argument while calling them. Now these APIs are expected to use our provided callback at some point.</p><h2 id="callbacks-in-c-can-be-of-3-types">Callbacks in C++ can be of 3 types</h2><ol><li><p>Function Pointer</p><li><p>Function Objects / Functors</p><li><p>Lambda functions</p></ol><p>Behaviour or result of the API is dependent on the callback we provide i.e. if we keep the input to API same and just change the callback then the output of API will change.</p><h3 id="using-function-pointer-as-callback">Using Function Pointer as callback</h3><p>From a framework we got an API that can build complete message from provided raw data. This API will perform following steps,</p><ul><li>Add header and footer in raw Data to make the message.<li>Encrypt the complete message.<li>Return the message</ul><p>Now this API knows what header and footer to apply but donâ€™t know about exact encryption logic, because that is not fixed to Framework, that can change from application to application. As, Encryption Logic is application dependent, therefore in this API provides a provision to pass encryption logic as a callback function pointer. This API will call back the code of application by calling this passed function pointer.</p><p><img data-proofer-ignore data-src="https://thispointer.com/wp-content/uploads/2015/07/callback.png" alt="Fig. 1: Callback Mechanism" /></p><p>Frameworkâ€™s API that accepts the function pointer callback as an argument is as follows,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>std::string buildCompleteMessage(std::string rawData, std::string (* encrypterFunPtr)(std::string) )
{
    // Add some header and footer to data to make it complete message
    rawData = "[HEADER]" + rawData + "[FooTER]";
    // Call the callBack provided i.e. function pointer to encrypt the
    rawData = encrypterFunPtr(rawData);
    return rawData;
}

</pre></table></code></div></div><p>Now when an application calls this API of framework to build the message, it passes a pointer to its local function as an argument.</p><p>In this case this a function Pointer is a Callback,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>//This encrypt function increment all letters in string by 1.
std::string encryptDataByLetterInc(std::string data)
{
    for(int i = 0; i &lt; data.size(); i++)
    {
        if( (data[i] &gt;= 'a' &amp;&amp; data[i] &lt;= 'z' ) || (data[i] &gt;= 'A' &amp;&amp; data[i] &lt;= 'Z' ) )
            data[i]++;
    }
    return data;
}
</pre></table></code></div></div><p>This encrypt function increment all letters in string by 1.</p><p>Now lets call build message API will this function as callback,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>std::string msg = buildCompleteMessage("SampleString", &amp;encryptDataByLetterInc);
    std::cout&lt;&lt;msg&lt;&lt;std::endl;
</pre></table></code></div></div><p><i> Output:</i></p><p>[IFBEFS]TbnqmfTusjoh[GppUFS]</p><p>&lt;/i&gt;</p><p>Now, lets design a new type of encryption function</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>//This encrypt function decrement all letters in string by 1.
std::string encryptDataByLetterDec(std::string data)
{
    for(int i = 0; i &lt; data.size(); i++)
    {
        if( (data[i] &gt;= 'a' &amp;&amp; data[i] &lt;= 'z' ) || (data[i] &gt;= 'A' &amp;&amp; data[i] &lt;= 'Z' ) )
            data[i]--;
    }
    return data;
}
</pre></table></code></div></div><p>This encrypt function decrement all letters in string by 1. Now lets call build message API will this function as callback,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>std::string msg = buildCompleteMessage("SampleString", &amp;encryptDataByLetterDec);
std::cout&lt;&lt;msg&lt;&lt;std::endl;
</pre></table></code></div></div><p><i> Output:</i></p><p>[GD@CDQ]R`lokdRsqhmf[EnnSDQ] &lt;/i&gt;</p><p>Now output of this call is different to earlier. We kept the API and passed data same but changed the passed callback, as a result behaviour or result of API changed.</p><p>This shows, that behaviour or result of the API is dependent on the callback passed as an argument.</p><h3 id="function-objects--functors">Function Objects &amp; Functors</h3><h4 id="what-is-a-function-objects">What is a Function Objects</h4><p>A Function Object / Functor is a kind of Callback with State.</p><p>Object of a class which has overloaded operator() is called Function Object or Functor i.e. a class with overloaded operator() function is as follows,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>#include &lt;iostream&gt;
class MyFunctor
{
public:
    int operator()(int a , int b)
    {
        return a+b;
    }
};
</pre></table></code></div></div><p>Now lets create a function object and call them,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>MyFunctor funObj;
std::cout&lt;&lt;funObj(2,3)&lt;&lt;std::endl;
</pre></table></code></div></div><p>Function objects / Functors can be called just like normal functions i.e.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>MyFunctor funObj;
funObj(2,3);
</pre></table></code></div></div><p>is similar to following code,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>MyFunctor funObj;
funObj.operator ()(2,3);
</pre></table></code></div></div><p>Letâ€™s understand by a practice example,</p><p>In previous part we discussed how to use function pointer call back to change the behaviour of message builder API.</p><ol><li>Letâ€™s refresh the problem statement,</ol><p>From a framework we got an API that can build complete message from provided raw data. This API will perform following steps,</p><ul><li>Add header and footer in raw Data to make the message.<li>Encrypt the complete message.<li>Return the message</ul><p>Now this API knows what header and footer to apply but donâ€™t know about exact encryption logic, because that is not fixed to Framework, that can change from application to application. As, Encryption Logic is application dependent, therefore it provides a provision to pass encryption logic as a callback function pointer,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>std::string buildCompleteMessage(std::string rawData,
        std::string (*encrypterFunPtr)(std::string)) {
    // Add some header and footer to data to make it complete message
    rawData = "[HEADER]" + rawData + "[FooTER]";
    // Call the callBack provided i.e. function pointer to encrypt the
    rawData = encrypterFunPtr(rawData);
    return rawData;
}
</pre></table></code></div></div><p>No suppose in our application we want to call this framework API three times with 3 different types of encryption logics i.e.</p><p><i> Encrypt by incrementing each letter by 1. Encrypt by incrementing each letter by 2. Encrypt by decrementing each letter by 1. </i></p><ol><li>How to this through function pointers</ol><p>For this we need to create three different types of functions and use them as function pointers while calling this API. 3 different functions here are necessary because normal global functions donâ€™t have any state associated with them,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre>//This encrypt function increment all letters in string by 1.
std::string encryptDataByLetterInc1(std::string data) {
    for (int i = 0; i &lt; data.size(); i++)
        if ((data[i] &gt;= 'a' &amp;&amp; data[i] &lt;= 'z')
                || (data[i] &gt;= 'A' &amp;&amp; data[i] &lt;= 'Z'))
            data[i]++;
    return data;
}
//This encrypt function increment all letters in string by 2.
std::string encryptDataByLetterInc2(std::string data) {
    for (int i = 0; i &lt; data.size(); i++)
        if ((data[i] &gt;= 'a' &amp;&amp; data[i] &lt;= 'z')
                || (data[i] &gt;= 'A' &amp;&amp; data[i] &lt;= 'Z'))
            data[i] = data[i] + 2;
    return data;
}
//This encrypt function increment all letters in string by 1.
std::string encryptDataByLetterDec(std::string data) {
    for (int i = 0; i &lt; data.size(); i++)
        if ((data[i] &gt;= 'a' &amp;&amp; data[i] &lt;= 'z')
                || (data[i] &gt;= 'A' &amp;&amp; data[i] &lt;= 'Z'))
            data[i] = data[i] - 1;
    return data;
}
int main() {
    std::string msg = buildCompleteMessage("SampleString",
            &amp;encryptDataByLetterInc1);
    std::cout &lt;&lt; msg &lt;&lt; std::endl;
    msg = buildCompleteMessage("SampleString", &amp;encryptDataByLetterInc2);
    std::cout &lt;&lt; msg &lt;&lt; std::endl;
    msg = buildCompleteMessage("SampleString", &amp;encryptDataByLetterDec);
    std::cout &lt;&lt; msg &lt;&lt; std::endl;
    return 0;
}
</pre></table></code></div></div><p>Is there any way to bind state with function pointers?</p><p>Answers is yes â€“ By making the them function objects or functors.</p><ol><li>Letâ€™s create a Function Object / Functor for Encryption:</ol><p>A function object or functor, is an object that has operator () defined as member function i.e.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>class Encryptor {
    bool m_isIncremental;
    int m_count;
public:
    Encryptor() {
        m_isIncremental = 0;
        m_count = 1;
    }
    Encryptor(bool isInc, int count) {
        m_isIncremental = isInc;
        m_count = count;
    }
    std::string operator()(std::string data) {
        for (int i = 0; i &lt; data.size(); i++)
            if ((data[i] &gt;= 'a' &amp;&amp; data[i] &lt;= 'z')
                    || (data[i] &gt;= 'A' &amp;&amp; data[i] &lt;= 'Z'))
                if (m_isIncremental)
                    data[i] = data[i] + m_count;
                else
                    data[i] = data[i] - m_count;
        return data;
    }
};
</pre></table></code></div></div><p>These function objects can be called just like functions in message builder API.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>std::string buildCompleteMessage(std::string rawData,
        Encryptor encyptorFuncObj) {
    // Add some header and footer to data to make it complete message
    rawData = "[HEADER]" + rawData + "[FooTER]";
    // Call the callBack provided i.e. function pointer to encrypt the
    rawData = encyptorFuncObj(rawData);
    return rawData;
}
</pre></table></code></div></div><p>What just happened here is a temporary object of EncruptFunctor is created and operator () is called on it.</p><p>It can also be called like,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Encryptor(true, 1);
</pre></table></code></div></div><p>It similar to calling,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Encryptor tempObj;
tempObj.operator(true, 1);
</pre></table></code></div></div><p>Now use this function object two solve our problem. Create a function object that can encrypt by decementing / increment each letter by specified number of times.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>int main() {
    std::string msg = buildCompleteMessage("SampleString", Encryptor(true, 1));
    std::cout &lt;&lt; msg &lt;&lt; std::endl;
    msg = buildCompleteMessage("SampleString", Encryptor(true, 2));
    std::cout &lt;&lt; msg &lt;&lt; std::endl;
    msg = buildCompleteMessage("SampleString", Encryptor(false, 1));
    std::cout &lt;&lt; msg &lt;&lt; std::endl;
    return 0;
}
</pre></table></code></div></div><p>So, this is how we can use function objects as callbacks.</p><p>Complete executable code is as follows,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre>#include &lt;iostream&gt;

class Encryptor {
    bool m_isIncremental;
    int m_count;
public:
    Encryptor() {
        m_isIncremental = 0;
        m_count = 1;
    }
    Encryptor(bool isInc, int count) {
        m_isIncremental = isInc;
        m_count = count;
    }
    std::string operator()(std::string data) {
        for (int i = 0; i &lt; data.size(); i++)
            if ((data[i] &gt;= â€˜aâ€™ &amp;&amp; data[i] &lt;= â€˜zâ€™)
                    || (data[i] &gt;= â€˜Aâ€™ &amp;&amp; data[i] &lt;= â€˜Zâ€™))
                if (m_isIncremental)
                    data[i] = data[i] + m_count;
                else
                    data[i] = data[i] â€“ m_count;
        return data;
    }

};

std::string buildCompleteMessage(std::string rawData,
        Encryptor encyptorFuncObj) {
    // Add some header and footer to data to make it complete message
    rawData = "[HEADER]" + rawData + "[FooTER]";

    // Call the callBack provided i.e. function pointer to encrypt the
    rawData = encyptorFuncObj(rawData);

    return rawData;
}

int main() {
    std::string msg = buildCompleteMessage("SampleString", Encryptor(true, 1));
    std::cout &lt;&lt; msg &lt;&lt; std::endl;

    msg = buildCompleteMessage("SampleString", Encryptor(true, 2));
    std::cout &lt;&lt; msg &lt;&lt; std::endl;

    msg = buildCompleteMessage("SampleString", Encryptor(false, 1));
    std::cout &lt;&lt; msg &lt;&lt; std::endl;

    return 0;
}

</pre></table></code></div></div><h3 id="c11-lambda-function">C++11 Lambda Function</h3><h4 id="what-is-a-lambda-function">What is a Lambda Function?</h4><p>Lambda functions are a kind of anonymous functions in C++. These are mainly used as callbacks in C++. Lambda function is like a normal function i.e.</p><ul><li>You can pass arguments to it<li>It can return the result</ul><p>But it doesnâ€™t have any name. Its mainly used when we have to create very small functions to pass as a callback to an another API.</p><p>Before going deep into lambda functions, lets understand what was the need of lambda functions.</p><h4 id="need-of-lambda-functions">Need of Lambda functions</h4><p>I have an array of int and I want to traverse on this array and print all ints using STL algorithm std::for_each.</p><p>Letâ€™s do that using a function pointer,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>#include &lt;iostream&gt;
#include &lt;algorithm&gt;
void display(int a)
{
    std::cout&lt;&lt;a&lt;&lt;" ";
}
int main() {
    int arr[] = { 1, 2, 3, 4, 5 };
    std::for_each(arr, arr + sizeof(arr) / sizeof(int), &amp;display);
    std::cout &lt;&lt; std::endl;
}
</pre></table></code></div></div><p>In this above example, to do a simple display we created a separate function. Is there any way through which we can achieve our requirement and also avoid this overhead.</p><h4 id="rise-of-lambda-functions">Rise of Lambda functions</h4><p>To resolve this, use we can use lambda functions. A lambda function is a kind of anonymous function which doesnâ€™t have any name but you can pass arguments and return results from it. Also all its content will work as in-line code.</p><p>Lambda function example is as follows,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>[](int x) {
        std::cout&lt;&lt;x&lt;&lt;" ";
    }
</pre></table></code></div></div><p>Here,</p><ul><li>[] is used to pass the outer scope elements<li>(int x) shows argument x is passed</ul><p>Letâ€™s see the above example with lambda functions,</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>#include &lt;iostream&gt;
#include &lt;algorithm&gt;
int main() {
    int arr[] = { 1, 2, 3, 4, 5 };
    std::for_each(arr, arr + sizeof(arr) / sizeof(int), [](int x) {
            std::cout&lt;&lt;x&lt;&lt;" ";
        });
    std::cout &lt;&lt; std::endl;
}
</pre></table></code></div></div><h4 id="how-to-pass-outer-scope-elements-inside-lambda-functions">How to pass outer scope elements inside lambda functions</h4><p>Case 1: Using [=]</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>    [=](int &amp;x) {
        // All outer scope elements has been passed by value
    }
</pre></table></code></div></div><p>Case 2: Using [&amp;]</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>    [&amp;](int &amp;x) {
        // All outer scope elements has been passed by reference
    }
</pre></table></code></div></div><p>Checkout this example this clearly shows how to use outer scope elements inside the lambda functions.</p><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>#include &lt;iostream&gt;
#include &lt;algorithm&gt;
int main() {
    int arr[] = { 1, 2, 3, 4, 5 };
    int mul = 5;
    std::for_each(arr, arr + sizeof(arr) / sizeof(int), [&amp;](int x) {
        std::cout&lt;&lt;x&lt;&lt;" ";
        // Can modify the mul inside this lambda function because
        // all outer scope elements has write access here.
            mul = 3;
        });
    std::cout &lt;&lt; std::endl;
    std::for_each(arr, arr + sizeof(arr) / sizeof(int), [=](int &amp;x) {
        x= x*mul;
        // Can not modify the mul inside this lambda function because
        // all outer scope elements has read only access here.
        // mul = 9;
        });
    std::cout &lt;&lt; std::endl;
    std::for_each(arr, arr + sizeof(arr) / sizeof(int), [](int x) {
        // No access to mul inside this lambda function because
        // all outer scope elements are not visible here.
        //std::cout&lt;&lt;mul&lt;&lt;" ";
        });
    std::cout &lt;&lt; std::endl;
}
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/theory/'>Theory</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/skill/" class="post-tag no-text-decoration" >Skill</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Designing Callbacks in C++ - Life Zero Blog&url=https://lacie-life.github.io/posts/Callback-Function-in-C++/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Designing Callbacks in C++ - Life Zero Blog&u=https://lacie-life.github.io/posts/Callback-Function-in-C++/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Designing Callbacks in C++ - Life Zero Blog&url=https://lacie-life.github.io/posts/Callback-Function-in-C++/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/ZED2-and-ORB-SLAM3/">ZED2 with ORB-SLAM3 (Stereo-IMU mode) step-by-step</a><li><a href="/posts/Callback-Function-in-C++/">Designing Callbacks in C++</a><li><a href="/posts/ML-for-3D-Geometry-4/">ML for 3D Geometry - Part 4</a><li><a href="/posts/ML-for-3D-Geometry-5/">ML for 3D Geometry - Part 5</a><li><a href="/posts/ML-for-3D-Geometry-10/">ML for 3D Geometry - Part 10</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/machine-learning/">Machine Learning</a> <a class="post-tag" href="/tags/theory/">Theory</a> <a class="post-tag" href="/tags/writting/">writting</a> <a class="post-tag" href="/tags/project/">Project</a> <a class="post-tag" href="/tags/note/">note</a> <a class="post-tag" href="/tags/collection/">collection</a> <a class="post-tag" href="/tags/cuda/">CUDA</a> <a class="post-tag" href="/tags/opencv/">openCV</a> <a class="post-tag" href="/tags/paper/">paper</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ML-for-3D-Geometry-4/"><div class="card-body"> <span class="timeago small" >Dec 1, 2022<i class="unloaded">2022-12-01T11:11:14+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ML for 3D Geometry - Part 4</h3><div class="text-muted small"><p> Shape Generation Goal: be able to generate shapes automatically. Usecases: for example, allow amateurs to create quality 3D models, and professionals to reduce repetitive work. Also, complete 3D s...</p></div></div></a></div><div class="card"> <a href="/posts/ML-for-3D-Geometry-5/"><div class="card-body"> <span class="timeago small" >Dec 1, 2022<i class="unloaded">2022-12-01T11:11:14+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ML for 3D Geometry - Part 5</h3><div class="text-muted small"><p> Learning on Different 3D Representations Types of 3D Represenations Volumetric grids =&gt; 3D CNNs Multi-view Point clouds Meshes Volumetric Grids More efficient than dense grid? =&gt;...</p></div></div></a></div><div class="card"> <a href="/posts/ML-for-3D-Geometry-10/"><div class="card-body"> <span class="timeago small" >Dec 2, 2022<i class="unloaded">2022-12-02T11:11:14+07:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>ML for 3D Geometry - Part 10</h3><div class="text-muted small"><p> Weak Supervision, n-shot Learning, Data Efficiency Broad motivation for this chapter: We want to use as little (annotated) data as possible, because data collection and data annotation are expensi...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ML-for-3D-Geometry-Note/" class="btn btn-outline-primary" prompt="Older"><p>ML for 3D Geometry - Note</p></a> <a href="/posts/ZED2-and-ORB-SLAM3/" class="btn btn-outline-primary" prompt="Newer"><p>ZED2 with ORB-SLAM3 (Stereo-IMU mode) step-by-step</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2023 <a href="https://twitter.com/username">Life Zero</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/machine-learning/">Machine Learning</a> <a class="post-tag" href="/tags/theory/">Theory</a> <a class="post-tag" href="/tags/writting/">writting</a> <a class="post-tag" href="/tags/project/">Project</a> <a class="post-tag" href="/tags/note/">note</a> <a class="post-tag" href="/tags/collection/">collection</a> <a class="post-tag" href="/tags/cuda/">CUDA</a> <a class="post-tag" href="/tags/opencv/">openCV</a> <a class="post-tag" href="/tags/paper/">paper</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://lacie-life.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
